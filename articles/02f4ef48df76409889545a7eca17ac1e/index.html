<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    
            <meta name="robots" content="noindex" />
        
    
            <meta name="robots" content="nofollow" />
        
    <meta name="description" content="C#とTypeScriptに関することをメインに書いています。" />

    <title>
        
                    [C#][TS] 静的サイトジェネレーター「Sitedig」の紹介 | Programmer&#39;s Note
                
    </title>

    
            <link rel="stylesheet" href="/sitegen-2.1.0/css/sitegen.css" />
        
            <link rel="stylesheet" href="/sitegen-2.1.0/css/sitegen-article.css" />
        

    <script type="module" src="/sitegen-2.1.0/js/initialize.js"></script>

    
    <link rel="icon" type="image/png" href="/images/favicon-32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/images/favicon-48.png" sizes="48x48" />
    <link rel="icon" type="image/png" href="/images/favicon-64.png" sizes="64x64" />
    <link rel="icon" type="image/png" href="/images/favicon-128.png" sizes="128x128" />
    <link rel="icon" type="image/png" href="/images/favicon-256.png" sizes="256x256" />
    <link rel="apple-touch-icon" href="/images/favicon-256.png" sizes="256x256" />
    <link rel="stylesheet" href="/css/custom-1.0.css" />
</head>
<body>
    <!-- サイトヘッダー -->
    <header id="sdi-header">
        <div id="sdi-header-inner">
            <div id="sdi-site-name"><a href="/">Programmer&#39;s Note</a></div>
            <div id="sdi-menu">
                <div class="sdc-menu-section">
                    
                                            <div>
                                                <a href="/categories/demo/">Demo</a>
                                            </div>
                                        
                                            <div>
                                                <a href="/categories/tech/">Tech</a>
                                            </div>
                                        
                                            <div>
                                                <a href="/categories/scrap/">Scrap</a>
                                            </div>
                                        
                </div>
                <div class="sdc-menu-section">
                    <div>
                        <a href="/tags/">Tags</a>
                    </div>
                    <div>
                        <a href="/search/">Search</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- メインコンテンツ -->
    <div id="sdi-container">
        <div id="sdi-container-inner">
            <main>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/styles/base16/nova.min.css" />
<script type="module">
    import hljs from "https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/es/highlight.min.js";
    hljs.highlightAll();
</script>
<script type="module">
    import mermaid from "https://unpkg.com/mermaid@9.1.3/dist/mermaid.esm.min.mjs";
    mermaid.initialize({ startOnLoad: true, theme: "base" });
</script>

<article id="sdi-entry-article">
    <!-- 記事ヘッダー -->
    <header>
        <!-- 記事タイトル -->
        <h1>[C#][TS] 静的サイトジェネレーター「Sitedig」の紹介</h1>

        <div id="sdi-article-header-annotation">
            <!-- タグ -->
            <div class="sdc-tags">
                <div class="sdc-tag sdc-primary-tag sdc-primary-tag1">
                    <a href="/categories/tech/">Tech</a>
                </div>
                
                                    <div class="sdc-tag">
                                        <a href="/tags/static-site-generator/">静的サイトジェネレーター</a>
                                    </div>
                                
                                    <div class="sdc-tag">
                                        <a href="/tags/cs/">C#</a>
                                    </div>
                                
                                    <div class="sdc-tag">
                                        <a href="/tags/typescript/">TypeScript</a>
                                    </div>
                                
            </div>

            <!-- 日付 -->
            <time datetime="2018-12-17">2018-12-17</time>
        </div>
    </header>

    <!-- 記事内容 -->
    <div id="sdi-article-body">
<p>この記事は「<a href="https://qiita.com/advent-calendar/2018/static-site-generator">静的サイトジェネレーター Advent Calendar 2018</a>」17日目の記事です。</p>
<h3>はじめに</h3>
<p>静的サイトジェネレーターを作ってみたので、その話と使い方の紹介です。</p>
<ul>
<li>GitHubリポジトリ
<ul>
<li><a href="https://github.com/yoshiheight/Crash.Pages">https://github.com/yoshiheight/Crash.Pages</a></li>
</ul>
</li>
</ul>
<p>サイト生成処理にはC#を使用しています。サイト内でのWebフロントエンド処理には（現在開発中の次期版では）TypeScriptを使用しています。</p>
<h3>自作した話</h3>
<h4>サイトの特徴</h4>
<p>どういうサイトが生成されるか、ですが、このサイト自体が自作の静的サイトジェネレーターで生成しています。</p>
<p>以下、主な特徴です。</p>
<ul>
<li>ページ構成
<ul>
<li>トップページ（記事一覧）</li>
<li>タグページ</li>
<li>検索結果ページ</li>
<li>各記事ページ</li>
</ul>
</li>
<li>検索機能</li>
<li>目次機能</li>
<li>レスポンシブデザイン</li>
</ul>
<h4>自作した理由</h4>
<p>既存のサービスや静的サイトジェネレーターを使うことも考えたのですが、最終的には以下の理由で自作することにしました。</p>
<ul>
<li>WordPress等のCMSではオーバースペックだし、構築や設定が面倒</li>
<li>既存のサービスだと外部のJavaScriptライブラリ等を組み込めない、組み込むのが面倒</li>
<li>既存のサービスだと他へ移行するときに面倒</li>
<li>広告を表示したくないし、有料プランにするぐらいならホスティングサービスを使う</li>
<li>表示速度を上げたい</li>
<li>独自ドメインを使用したい</li>
<li>Qiitaの様な技術情報限定のサービスの場合、他の人と記事内容がかぶっていると、なんか上げにくい</li>
<li>自サイトの方が内容を気にせず、また自分用備忘録的なものも上げやすい</li>
<li>シンプルな画面構成にしたい、デザインを好きなようにしたい</li>
<li>一覧表示はページングしないで全部表示したい</li>
<li>Markdownの記事はGitで管理してVisual Studio Codeで編集したい</li>
<li>HTML、CSS、JavaScriptは最近さわっていなかったので、ちょっとさわっておきたい</li>
<li>C#製MarkdownライブラリのMarkDigを試してみたい</li>
<li>ただ単に<code>.NET Core</code>でなにか作りたかった</li>
<li>既存のものをいろいろカスタムするより、自作した方が早いと思った</li>
</ul>
<p>自分にとって上記を全て満たす方法が「自作＋好きなホスティングサービスで公開」だったわけです。</p>
<h4>フロントエンドで使用しているライブラリ、リソース</h4>
<ul>
<li><a href="https://jquery.com/">https://jquery.com/</a></li>
<li><a href="https://fonts.google.com/">https://fonts.google.com/</a></li>
<li>以下は現在開発中の次期Crash.Pagesの場合
<ul>
<li><a href="https://lodash.com/">https://lodash.com/</a></li>
<li><a href="https://highlightjs.org/">https://highlightjs.org/</a></li>
<li><a href="https://mermaidjs.github.io/">https://mermaidjs.github.io/</a></li>
</ul>
</li>
</ul>
<h3>環境構築</h3>
<p>配布用バイナリは用意していません。もともと自分用に作っていたというのもあり、ちょっと面倒なんですが、前述のGitHubリポジトリから取得してVisual Studioでビルドが必要です。</p>
<p>というか、テンプレートにT4Templateを使用しているので、サイトヘッダーやフッター、プロフィールの記述など、Visual Studioがないとできません。</p>
<h4>プロジェクト構成</h4>
<table>
<thead>
<tr>
<th>プロジェクト</th>
<th>内容</th>
<th>形態</th>
</tr>
</thead>
<tbody>
<tr>
<td>Crash.Core</td>
<td>共通ライブラリ</td>
<td><code>.NET Standard</code>ライブラリ</td>
</tr>
<tr>
<td>Crash.Pages</td>
<td>静的サイトジェネレーター本体</td>
<td><code>.NET Core</code>コンソールアプリ</td>
</tr>
<tr>
<td>Crash.Pages.Model</td>
<td>処理モデル</td>
<td><code>.NET Core</code>ライブラリ</td>
</tr>
<tr>
<td>Crash.Pages.Storage</td>
<td>ファイルIO関連</td>
<td><code>.NET Core</code>ライブラリ</td>
</tr>
<tr>
<td>SimpleWebServer</td>
<td>簡易Webサーバー</td>
<td><code>ASP.NET Core</code></td>
</tr>
</tbody>
</table>
<ul>
<li>SimpleWebServerは独立したプロジェクトです。必要に応じて、ローカル環境でのサイト内容確認に使用してください</li>
</ul>
<h4>ユーザー指定部分</h4>
<p>文字列「ユーザー指定部分」で検索するとヒットする以下の箇所がユーザー固有の記述部分ですので、書き換えてください。</p>
<ul>
<li>Page.cs
<ul>
<li>サイト名</li>
</ul>
</li>
<li>LayoutTemplate.tthtml
<ul>
<li>サイトヘッダー</li>
<li>プロフィール</li>
<li>サイトフッター</li>
</ul>
</li>
</ul>
<h4>ビルド手順</h4>
<ol>
<li>「すべてのT4テンプレートの変換」を実行</li>
<li>Release版でソリューションのリビルドを実行</li>
</ol>
<h4>ディレクトリの用意</h4>
<p>入力元ディレクトリを以下の構成で用意してください。</p>
<pre><code class="language-txt">+ 入力元ディレクトリ（任意の名前）
    + _drafts   下書き用
    + _posts    公開用
</code></pre>
<p>出力先ディレクトリのルートを用意してください。サブディレクトリはモードに応じて自動生成されます。</p>
<pre><code class="language-txt">+ 出力先ディレクトリ（任意の名前）
    + _preview  プレビューモードでの生成先
    + _site     本番モードでの生成先
</code></pre>
<h3>サイト生成</h3>
<h4>記事の作成</h4>
<p>Markdownファイルを以下のファイル名で文字コード<code>UTF-8</code>で作成してください。BOMの有無や改行コードは何でも大丈夫です。</p>
<pre><code class="language-txt">YYYY-MM-DD-記事タイトル.md
</code></pre>
<p>ファイルの先頭にはYAMLで記事のメタデータを埋め込む必要があります。</p>
<pre><code class="language-yaml">---
id: &quot;my-page&quot;
tags: [&quot;Markdown&quot;, &quot;静的サイト&quot;]
---
</code></pre>
<ul>
<li>記事IDはパーマリンクの一部として使用されます
<ul>
<li><code>/pages/記事ID/</code></li>
</ul>
</li>
<li>記事内での見出しはh3からh5を使用してください</li>
<li>出力されるHTMLファイルの文字コードは<code>UTF-8 BOM無し</code>、改行コードは<code>LF</code>になります</li>
<li>出力されるHTMLファイルのタイムスタンプは、もとのMarkdownファイルと同じになります</li>
<li>Markdown以外のファイルはそのまま出力先ディレクトリにコピーされます</li>
</ul>
<h4>サイト生成の実行</h4>
<p>以下のコマンドを実行します。</p>
<pre><code class="language-txt">dotnet ＜Crash.Pages.dllパス＞ --src=＜入力元ディレクトリパス＞ --dest=＜出力先ディレクトリパス＞
</code></pre>
<ul>
<li><code>--preview</code>オプション
<ul>
<li>プレビューモードで実行します。下書き記事もHTML変換され、また全記事の先頭にMarkdownファイルパスが表示されます</li>
</ul>
</li>
</ul>
<h4>サイト内容の確認</h4>
<p>SimpleWebServerでサイト内容を確認する場合、以下のコマンドを実行します。</p>
<pre><code class="language-txt">dotnet ＜SimpleWebServer.dllパス＞ ＜ポート番号＞ ＜生成先ディレクトリパス＞
</code></pre>
<h3>おわりに</h3>
<p>実際に作ってみて、自分の欲しかったものができ、更に <code>HTML5</code>, <code>CSS3</code>, <code>ECMAScript 2015</code> もいろいろ試すことができました。</p>
<p>既存のものが気に入らなければ、自分で作ってしまうのも、たまにはいいのではないでしょうか。</p>

    </div>
</article>
            </main>
        </div>
    </div>

    <!-- サイトフッター -->
    <footer id="sdi-footer">
        <div id="sdi-footer-inner">
            
            <!-- プロフィール -->
            <div style="font-size: 115%; line-height: 1.1;">
                <div style="display: flex;">
                    <div style="flex-shrink: 0;">
                        <img src="/images/favicon-128.png" style="margin-right: 20px; border: 2px solid #e4e4e4; border-radius: 50%;" />
                    </div>
                    <div style="padding-top: 5px;">
                        <div style="display: flex; align-items: flex-end; flex-wrap: wrap; column-gap: 8px;">
                            <div style="font-size: 110%;">Yoshiheight</div>
                            <div>/</div>
                            <div style="font-size: 90%;">Programmer</div>
                        </div>
                        <div style="margin: 0.5em 0;">C#とTypeScriptに関することをメインに書いています。</div>
                        <div style="margin-top: 25px; text-decoration: underline;">
                            <a href="https://github.com/yoshiheight">GitHub</a>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; font-size: 98%;">
                Generated by <a style="text-decoration: underline;" href="https://github.com/yoshiheight/Sitegen">Sitegen</a>
            </div>
        </div>
    </footer>
</body>
</html>
